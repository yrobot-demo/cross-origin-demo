<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>auth</title>
</head>

<body>
  <script>

    const login = () => {
      fetch("http://cross1:3000/login", {
        headers: {
          "content-type": "application/json",
          token: localStorage.getItem('token')
        },
        credentials: 'include',
        body: JSON.stringify({}), // must match 'Content-Type' header
        method: "POST", // *GET, POST, PUT, DELETE, etc.
      })
        .then(function (response) {
          return response.json();
        })
        .then(function (myJson) {
          console.log(myJson);
          const { token } = myJson || {}
          localStorage.setItem('token', token)
        });
    }

    const logout = () => {
      localStorage.removeItem('token')
    }

    window.addEventListener("message", function (event) {
      const { type } = event.data || {}
      switch (type) {
        case 'LOGIN':
          login()
          break;
        case 'LKOGOUT':
          logout()
          break;
      }
    }, false)
  </script>
</body>

</html>